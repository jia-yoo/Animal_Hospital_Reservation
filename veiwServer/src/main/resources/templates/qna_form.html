<!DOCTYPE html>
<html class="h-100" xmlns:th="http://www.thymeleaf.org">
<head>
<meta charset="UTF-8">
<title>견강할고양</title>
<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-QWTKZyjpPEjISv5WaRU9OFeRpok6YctnYmDr5pNlyT2bRjXh0JMhjY6hW+ALEwIH" crossorigin="anonymous">
<link href="/css/style.css" rel="stylesheet">
<link rel="preconnect" href="https://fonts.googleapis.com">
<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
<link href="https://fonts.googleapis.com/css2?family=Do+Hyeon&family=Jua&display=swap" rel="stylesheet">
</head>

<body class="d-flex flex-column h-100">
<div th:replace="~{user/header :: header}"></div>
<div class="container-xl">


<h1 class="mt-3 mt-md-5 mb-3 mb-md-3">문의 등록</h1>
<hr>

<div>
    <label for="category" class="form-label">문의 카테고리</label>
    <select id="category" class="form-select" name="category">
        <option value="">선택하세요</option>
        <option value="불편신고">불편신고</option>
        <option value="기타문의">기타문의</option>
        <option value="경매신청">경매신청</option>
        <option value="펀딩신청">펀딩신청</option>
    </select>
</div>



<div class="form-floating">
  <textarea name="title" class="form-control" placeholder="문의 제목을 작성해주세요" id="title"></textarea>
  <label for="title">제목</label>
</div>

<div class="form-floating">
  <textarea name="content" class="form-control" placeholder="문의 내용을 작성해주세요" id="content" style="height: 300px"></textarea>
  <label for="content">내용</label>
</div>


<button type="submit" class="btn btn-primary" id="regBtn">등록하기</button>



</div>
<div th:replace="~{user/footer :: footer}"></div>
<script>

document.getElementById('regBtn').addEventListener('click', function() {
    const formData = new FormData();

    formData.append('title', document.querySelector('textarea[name="title"]').value);
    formData.append('content', document.querySelector('textarea[name="content"]').value);
    formData.append('category', document.querySelector('select[name="category"]').value);
    
    
    const xhttp = new XMLHttpRequest();
    xhttp.open("POST", "http://localhost:9001/qna", true);
    xhttp.onload = function() {
        if (xhttp.status === 200) {
            console.log("문의 등록 성공!");
            alert("문의가 성공적으로 등록되었습니다.");
            window.location.href="/qnaList";
        } else {
            console.error("문의 등록 실패");
            alert("문의 등록에 실패했습니다.");
        }
    };
    xhttp.onerror = function() {
        console.error("AJAX 요청 실패");
        alert("문의 등록 중 오류가 발생했습니다.");
    };
    xhttp.send(formData);
});




document.getElementById('category').addEventListener('change', function() {
    var contentTextarea = document.getElementById('content');
    var selectedValue = this.value;
    
    if (selectedValue === '경매신청') {
        contentTextarea.value = '사용기한: \n의료상품명: \n병원명: \n경매시작일: \n경매마감일: \n경매시작가: \n상한가: \n내용: \n\n위의 해당양식을 모두 작성해주세요';
    } else if (selectedValue === '펀딩신청') {
        contentTextarea.value = '사용기한: \n의료상품명: \n병원명: \n금액: \n인원 수: \n펀딩시작일: \n펀딩마감일: \n내용: \n\n의 해당양식을 모두 작성해주세요';
    } else {
        contentTextarea.value = '';
        contentTextarea.placeholder = '문의 내용을 작성해주세요';
    }
});

</script>
<script src="https://code.jquery.com/jquery-3.7.1.js" integrity="sha256-eKhayi8LEQwp4NKxN+CfCh+3qOVUtJn3QNZ0TciWLP4=" crossorigin="anonymous"></script>
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js" integrity="sha384-YvpcrYf0tY3lHB60NNkmXc5s9fDVZLESaAA55NDzOxhy9GkcIdslK1eN7N6jIeHz" crossorigin="anonymous"></script>
</body>
</html>